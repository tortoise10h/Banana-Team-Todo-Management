@model TodoDetailViewModel;

@{
    ViewData["Title"] = "Details";
}

@section Scripts {
    <script src="~/js/highlight-status-label-script.js" asp-append-version="true"></script>
}

<div class="row">
    <div class="col-12">
        <div class="page-title-box d-flex align-items-center">
            <a href="#"
                class="dropdown-toggle arrow-none mr-2"
                data-toggle="dropdown"
                aria-expanded="false"
                onClick="history.go(-1);">
                <svg width="3em" height="3em" viewBox="0 0 16 16" class="bi bi-arrow-left-short" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M12 8a.5.5 0 0 1-.5.5H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H11.5a.5.5 0 0 1 .5.5z" />
                </svg>
            </a>
            <h4 class="page-title">Task Detail</h4>
        </div>
    </div>
</div>
<!-- end page title -->

<div class="row">
    <div class="col-xl-8 col-lg-7">
        <!-- project card -->
        <div class="card d-block">
            <div class="card-body">
                <div class="dropdown card-widgets">
                    <a href="#"
                        class="dropdown-toggle arrow-none"
                        data-toggle="dropdown"
                        aria-expanded="false">
                        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-three-dots" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z" />
                        </svg>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <!-- item-->
                        <a href="javascript:void(0);" class="dropdown-item">
                            <i class="uil uil-file-upload mr-1"></i>Attachment
                        </a>
                        <!-- item-->
                        <a class="dropdown-item" asp-action="Edit"
                            asp-controller="Todo"
                            asp-route-id="@Model.TodoId">
                            <i class="uil uil-edit mr-1"></i>Edit
                        </a>
                        <div class="dropdown-divider"></div>
                        <!-- item-->
                        <a href="javascript:void(0);"
                            class="dropdown-item text-danger">
                            <i class="uil uil-trash-alt mr-1"></i>Delete
                        </a>
                    </div>
                    <!-- end dropdown menu-->
                </div>
                <!-- end dropdown-->

                <div>
                    <span class="badge font-15 ml-1 p-1" title="@Model.TodoInfo.Scope">@Model.TodoInfo.Scope</span>
                </div>
                <!-- end custom-checkbox-->

                <div class="clearfix"></div>

                <h3 class="d-flex align-items-center mt-3">
                    @Model.TodoInfo.Name
                    <span class="badge font-15 ml-1 p-1" title="@Model.TodoInfo.Status">@Model.TodoInfo.Status</span>
                </h3>

                <div class="row">
                    <div class="col-6">
                        <!-- assignee -->
                        @if (@Model.TodoInfo.PersonInCharge != null)
                        {
                            <p class="mt-2 mb-1 text-muted font-weight-bold font-12 text-uppercase">
                                Person in charge
                            </p>
                            <div class="media">
                                <img src="~/images//avatars//avatar-demo.jpg"
                                    alt="Arya S"
                                    class="rounded-circle mr-2"
                                    height="24" />
                                <div class="media-body">
                                    <h5 class="mt-1 font-14">@Model.TodoInfo.PersonInCharge.LastName  @Model.TodoInfo.PersonInCharge.FirstName</h5>
                                </div>
                            </div>
                        }
                        <!-- end assignee -->
                    </div>
                    <!-- end col -->

                    <div class="col-6">
                        <!-- start due date -->
                        <p class="mt-2 mb-1 text-muted font-weight-bold font-12 text-uppercase">
                            Due Date
                        </p>
                        <div class="media">
                            <i class="far fa-calendar-alt font-18 mr-1 text-success mr-1"
                                style="line-height: 1.5rem"></i>
                            <div class="media-body">
                                <h5 class="mt-1 font-14">Today 10am</h5>
                            </div>
                        </div>
                        <!-- end due date -->
                    </div>
                    <!-- end col -->
                </div>
                <!-- end row -->

                @if (@Model.TodoInfo.Description != null && @Model.TodoInfo.Description.Length > 0)
                {
                    <h5 class="mt-3">Description:</h5>

                    <p class="text-muted mb-4">
                        @Model.TodoInfo.Description
                    </p>
                }
                @if (Model.Participants != null)
                {
                    <h5 class="mt-3">Participants:</h5>

                    @foreach (var user in Model.Participants)
                    {
                        <div class="media">
                            <img src="~/images//avatars//avatar-demo.jpg"
                                alt="Arya S"
                                class="rounded-circle mr-2"
                                height="24" />
                            <div class="media-body">
                                <h5 class="mt-1 font-14">@user.FullName</h5>
                            </div>
                        </div>
                    }
                }
            </div>
            <!-- end card-body-->
        </div>
        <!-- end card-->

        <div class="card">
            <div class="card-header">
                <h4 class="my-1">Comments (@Model.TodoInfo.Comments.Count())</h4>
            </div>
            <div class="card-body">
                @{ 
                    var comments = @Model.TodoInfo.Comments;
                    foreach (var comment in comments)
                    {   
                        <div class="media mb-3">
                            <img class="mr-2 rounded-circle"
                                    src="~/images//avatars//avatar-demo.jpg"
                                    alt="Generic placeholder image"
                                    height="32" />
                            <div class="media-body">
                                <h5 class="mt-0">
                                    @comment.User.FullName
                                    <div class="float-right">
                                        <small class="text-muted mr-2">@comment.CreatedAt.ToLongDateString()</small>
                                        @if(ViewBag.UserId == comment.UserId)
                                        {
                                            <div class="dropdown card-widgets">
                                                <a href="#"
                                                    class="dropdown-toggle arrow-none"
                                                    data-toggle="dropdown"
                                                    aria-expanded="false">
                                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-three-dots" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd" d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z" />
                                                    </svg>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-right">
                                                    <a href="javascript:void(0);"
                                                        class="dropdown-item text-danger">
                                                        <i class="uil uil-trash-alt mr-1"></i>Delete
                                                    </a>
                                                </div>
                                            </div>
                                        }
                                    </div>
                                </h5>
                                @comment.Content
                                <br />
                            </div>
                        </div>
                    }
                }

                <div class="border rounded mt-4">
                    <form 
                        asp-action="PostComment"
                        asp-route-id="@Model.TodoId"
                        asp-controller="Todo"
                        method="post"
                        class="comment-area-box">
                        <textarea rows="3"
                            class="form-control border-0 resize-none"
                            name="CommentContent"
                            placeholder="Your comment..."
                            required
                        ></textarea>
                        <div class="p-2 bg-light d-flex justify-content-between align-items-center">
                            <button type="submit" class="btn btn-sm btn-success">
                                <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-cursor mr-1" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                    <path fill-rule="evenodd" d="M14.082 2.182a.5.5 0 0 1 .103.557L8.528 15.467a.5.5 0 0 1-.917-.007L5.57 10.694.803 8.652a.5.5 0 0 1-.006-.916l12.728-5.657a.5.5 0 0 1 .556.103zM2.25 8.184l3.897 1.67a.5.5 0 0 1 .262.263l1.67 3.897L12.743 3.52 2.25 8.184z" />
                                </svg>Submit
                            </button>
                        </div>
                    </form>
                </div>
                <!-- end .border-->
            </div>
            <!-- end card-body-->
        </div>
        <!-- end card-->
    </div>
    <!-- end col -->

    <div class="col-xl-4 col-lg-5">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-3">Attachments</h5>

                <form action="/"
                    method="post"
                    class="dropzone dz-clickable"
                    id="myAwesomeDropzone"
                    data-plugin="dropzone"
                    data-previews-container="#file-previews"
                    data-upload-preview-template="#uploadPreviewTemplate">
                    <div class="dz-message needsclick">
                        <i class="h3 text-muted dripicons-cloud-upload"></i>
                        <h4>Drop files here or click to upload.</h4>
                    </div>
                </form>

                <!-- Preview -->
                <div class="dropzone-previews mt-3" id="file-previews"></div>

                <!-- file preview template -->
                <div class="d-none" id="uploadPreviewTemplate">
                    <div class="card mt-1 mb-0 shadow-none border">
                        <div class="p-2">
                            <div class="row align-items-center">
                                <div class="col-auto">
                                    <img data-dz-thumbnail=""
                                        src="#"
                                        class="avatar-sm rounded bg-light"
                                        alt="" />
                                </div>
                                <div class="col pl-0">
                                    <a href="javascript:void(0);"
                                        class="text-muted font-weight-bold"
                                        data-dz-name=""></a>
                                    <p class="mb-0" data-dz-size=""></p>
                                </div>
                                <div class="col-auto">
                                    <!-- Button -->
                                    <a href=""
                                        class="btn btn-link btn-lg text-muted"
                                        data-dz-remove="">
                                        <i class="dripicons-cross"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end file preview template -->

                <div class="card my-1 shadow-none border">
                    <div class="p-2">
                        <div class="row align-items-center">
                            <div class="col-auto">
                                <div class="avatar-sm">
                                    <span class="avatar-title rounded"> .ZIP </span>
                                </div>
                            </div>
                            <div class="col pl-0">
                                <a href="javascript:void(0);"
                                    class="text-muted font-weight-bold">Hyper-admin-design.zip</a>
                                <p class="mb-0">2.3 MB</p>
                            </div>
                            <div class="col-auto">
                                <!-- Button -->
                                <a href="javascript:void(0);"
                                    class="btn btn-link btn-lg text-muted">
                                    <i class="dripicons-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mb-1 shadow-none border">
                    <div class="p-2">
                        <div class="row align-items-center">
                            <div class="col-auto">
                                <img src="assets/images/projects/project-1.jpg"
                                    class="avatar-sm rounded"
                                    alt="file-image" />
                            </div>
                            <div class="col pl-0">
                                <a href="javascript:void(0);"
                                    class="text-muted font-weight-bold">Dashboard-design.jpg</a>
                                <p class="mb-0">3.25 MB</p>
                            </div>
                            <div class="col-auto">
                                <!-- Button -->
                                <a href="javascript:void(0);"
                                    class="btn btn-link btn-lg text-muted">
                                    <i class="dripicons-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mb-0 shadow-none border">
                    <div class="p-2">
                        <div class="row align-items-center">
                            <div class="col-auto">
                                <div class="avatar-sm">
                                    <span class="avatar-title bg-secondary rounded">
                                        .MP4
                                    </span>
                                </div>
                            </div>
                            <div class="col pl-0">
                                <a href="javascript:void(0);"
                                    class="text-muted font-weight-bold">Admin-bug-report.mp4</a>
                                <p class="mb-0">7.05 MB</p>
                            </div>
                            <div class="col-auto">
                                <!-- Button -->
                                <a href="javascript:void(0);"
                                    class="btn btn-link btn-lg text-muted">
                                    <i class="dripicons-download"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

